#!/bin/sh
while true ; do
NOTIFICATION=`inotifywait -q ~/irc -r`
TYPE=`echo $NOTIFICATION | cut -f2 -d ' '`
FILE=`echo $NOTIFICATION | cut -f1 -d ' '`
SERVER=`echo $FILE | cut -f5 -d '/'`
ENTITY=`echo $FILE | cut -f6 -d '/'`

(
    echo $ENTITY | grep -qv '#' ||
    tail -n 1 $FILE/out | cut -b20- | grep -q $USER
) && \
    MESSAGE=`tail -n 1 $FILE/out | cut -b18-` && \
    notify-send "$MESSAGE" "($ENTITY@$SERVER)" -i gtk-dialog-info

done ;
